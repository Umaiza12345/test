# This is the name of your workflow. It will show up in the Actions tab.
name: CI Matrix Build

# This controls when the workflow will run.
# on: [push] means it runs on every push to the repository.
on: [push]

# This section defines the "jobs" to run.
jobs:
  # 'build' is the name of our job. You can call it anything.
  build:
    # This tells GitHub to run the job on the latest version of Ubuntu.
    runs-on: ubuntu-latest

    # This is the "matrix" strategy section.
    strategy:
      matrix:
        # We define a variable 'node-version' and give it a list of 3 values.
        # GitHub will create 3 separate, parallel jobs, one for each value.
        # You could also use 'python-version' or 'os: [ubuntu-latest, macos-latest, windows-latest]'
        node-version: [18, 20, 22]

    # 'steps' are the individual commands that run inside each job.
    steps:
      # Step 1: A required step for this challenge with a specific ID.
      - name: Matrix build step with required ID
        id: matrix-ca4dc59  # This is the Step Identifier you needed.
        run: echo "Starting build for Node.js ${{ matrix.node-version }}"

      # Step 2: Set up the specific Node.js version for this job.
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}

      # Step 3: Generate a unique build artifact (a simple text file).
      - name: Generate build artifact
        run: |
          # Create a text file with content specific to this build variant.
          echo "This is the build artifact for Node.js version ${{ matrix.node-version }}." > build-log.txt
          echo "Build completed at $(date)" >> build-log.txt

      # Step 4: Upload the generated file as an artifact.
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          # This name is constructed dynamically using the matrix variable.
          # It satisfies the 'build-ca4dc59-<variant>' requirement.
          name: build-ca4dc59-node${{ matrix.node-version }}
          
          # This is the path to the file we want to upload.
          path: build-log.txt
